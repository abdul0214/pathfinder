plugins {
    id 'org.springframework.boot' version '2.7.4'
    id 'io.spring.dependency-management' version '1.0.14.RELEASE'
    id 'java'
    id("com.github.johnrengelman.shadow") version "6.0.0"
}

group = 'com.camunda'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = '11'

configurations {
    compileOnly {
        extendsFrom annotationProcessor
    }
}

repositories {
    mavenCentral()
}

ext {
    set('springCloudVersion', "2021.0.4")
}

dependencies {
    implementation 'org.springframework.cloud:spring-cloud-starter-openfeign'
    compileOnly 'org.projectlombok:lombok'
    annotationProcessor 'org.projectlombok:lombok'
    implementation 'org.camunda.bpm:camunda-engine:7.9.0'
    implementation 'com.fasterxml.jackson.dataformat:jackson-dataformat-xml'
}

dependencyManagement {
    imports {
        mavenBom "org.springframework.cloud:spring-cloud-dependencies:${springCloudVersion}"
    }
}

jar {
    manifest {
        attributes 'Main-Class': 'PathfinderApplication'
    }
}

//jar {
//    manifest.attributes["Main-Class"] = "PathfinderApplication"
//    val dependencies = configurations
//            .runtimeClasspath
//            .get()
//            .map(::zipTree) // OR .map { zipTree(it) }
//    from(dependencies)
//    duplicatesStrategy = DuplicatesStrategy.EXCLUDE
//}
//tasks.jar {
//    manifest.attributes["Main-Class"] = "PathfinderApplication"
//}